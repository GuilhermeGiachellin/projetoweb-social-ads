@{
	var logado = ViewBag.UsuarioLogado;
}

<div class="body ">

	<div class="container">
		<div class="profile-page tx-13">
			<div class="row">
				<div class="col-12 grid-margin">
					<div class="profile-header">
						<div class="cover">
							<div class="gray-shade"></div>
							<figure>
								<img src="https://t.ctcdn.com.br/JtxqlT7X1-WrrL4yuAebx7ubVaI=/1200x675/smart/i726432.jpeg" class="img-fluid" alt="profile cover">
							</figure>
							<div class="cover-body d-flex justify-content-between align-items-center">
								<div>
									<img class="profile-pic" src="https://cdn.pixabay.com/photo/2018/04/27/03/50/portrait-3353699_640.jpg" alt="profile">
									<span class="profile-name">@logado.Nome @logado.Sobrenome</span>
								</div>
								<div class="d-none d-md-block">
									<button class="btn btn-primary btn-icon-text btn-edit-profile">
										<i class="las la-edit btn-icon-prepend"></i>
										AMIGOS
									</button>
								</div>
							</div>
						</div>
						<div class="header-links">
							<ul class="links d-flex align-items-center mt-3 mt-md-0">

								<li class="header-link-item ml-3 pl-3 border-left d-flex align-items-center ms-4">
									<i class="las la-user mr-1 icon-md"></i>
									<a class="pt-1px d-none d-md-block">Sobre</a>
								</li>
								<li class="header-link-item ml-3 pl-3 border-left d-flex align-items-center ms-4">
									<i class="las la-users mr-1 icon-md"></i>
									<a class="pt-1px d-none d-md-block">Amigos <span class="text-muted tx-12 ms-4">3,765</span></a>
								</li>
								<li class="header-link-item ml-3 pl-3 border-left d-flex align-items-center ms-4">
									<i class="las la-image mr-1 icon-md"></i>
									<a class="pt-1px d-none d-md-block">Fotos</a>
								</li>
								<li class="header-link-item ml-3 pl-3 border-left d-flex align-items-center ms-4">
									<i class="las la-video mr-1 icon-md"></i>
									<a class="pt-1px d-none d-md-block">Videos</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>

			<div class="row">
				<!-- left wrapper start -->
				<div class="d-none d-md-block col-md-4 col-xl-3">
					<div class="card rounded">
						<div class="card-body">
							<div class="d-flex align-items-center justify-content-between mb-2">
								<h6>Sobre</h6>
								<div class="dropdown">
									<button class="btn p-0" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<i class="las la-ellipsis-h icon-lg pb-3px"></i>
									</button>
									<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
										<a class="dropdown-item d-flex align-items-center" href="#">
											<i class="las la-edit icon-sm mr-2"></i> <span class="">Edit</span>
										</a>
										<a class="dropdown-item d-flex align-items-center" href="#">
											<i class="las la-code-branch icon-sm mr-2"></i> <span class="">Update</span>
										</a>
										<a class="dropdown-item d-flex align-items-center" href="#">
											<i class="las la-eye icon-sm mr-2"></i> <span class="">View all</span>
										</a>
									</div>
								</div>
							</div>

							<p>@logado.Bio</p>

							<div class="mt-3">
								<label class="tx-11 font-weight-bold mb-0 text-uppercase">Nascido:</label>
								<p class="text-muted">November 15, 2015</p>
							</div>
							<div class="mt-3">
								<label class="tx-11 font-weight-bold mb-0 text-uppercase">Email:</label>
								<p class="text-muted">@logado.Email</p>
							</div>
							<div class="mt-3 d-flex social-links">
								<a href="javascript:;" class="btn d-flex align-items-center justify-content-center border mr-2 btn-icon github">
									<i class="lab la-github icon-lg pb-3px" data-toggle="tooltip" title="" data-original-title="github.com/nobleui"></i>
								</a>
								<a href="javascript:;" class="btn d-flex align-items-center justify-content-center border mr-2 btn-icon twitter">
									<i class="lab la-twitter icon-lg pb-3px" data-toggle="tooltip" title="" data-original-title="twitter.com/nobleui"></i>
								</a>
								<a href="javascript:;" class="btn d-flex align-items-center justify-content-center border mr-2 btn-icon instagram">
									<i class="lab la-instagram icon-lg pb-3px" data-toggle="tooltip" title="" data-original-title="instagram.com/nobleui"></i>
								</a>
							</div>

						</div>
					</div>

					<div>
						<div class="card-body">
							<div class="justify-content-between mb-2 pb-2">
								<h6 class="card-title mb-3">Anúncios</h6>

								<div class="row" id="principal">
									<div class="row d-flex" id="anuncio" style="display: flex; flex-wrap: nowrap;">

										<img src="img/img1.jpg">

										<img src="img/img2.jpg">

										<img src="img/img3.jpg">

										<img src="img/img4.jpg">

									</div>
								</div>
								<div id="info"></div>
							</div>
						</div>
					</div>
				</div>

				<!-- left wrapper end -->
				<!-- middle wrapper start -->
				<div class="col-md-8 col-xl-6 middle-wrapper">
					<div class="row">
						<div class="col-md-12 grid-margin">
							<div class="card rounded">
								<!--Criar PUBLICACAO-->
								<form class="mt-4" asp-controller="Usuario" asp-action="CriarPublicacao" method="post">
									<div class="card-header">
										<div class="d-flex align-items-center justify-content-between ">
											<div class="dropdown" style="width: 100%">
												<div class="d-flex align-items-center justify-content-start">
													<div class="row mt-3">
														<p>@logado.Nome @logado.Sobrenome</p>
													</div>
												</div>

												<div class="mb-3 input-group m-2" style="width: 100%">
													<textarea type="text" class="form-control" rows="3" id="CriarPublicacao.descricao" name="descricao" placeholder="No que você esta pensando"></textarea>
												</div>

												<ul class="nav nav-pills nav-stack small fw-normal">
													<li class="nav-item m-2">
														<button class="btn btn-shadow mr-3" type="submit">Postar</button>
													</li>
												</ul>
											</div>

											<div class="dropdown">
												<button class="btn p-0" type="button" id="dropdownMenuButton2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
													<i class="las la-ellipsis-h icon-lg pb-3px"></i>
												</button>
												<div class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
													<a class="dropdown-item d-flex align-items-center" href="#">
														<i class="las la-meh icon-sm mr-2"></i> <span class="">Unfollow</span>
													</a>
													<a class="dropdown-item d-flex align-items-center" href="#">
														<i class="las la-level-up-alt icon-sm mr-2"></i> <span class="">Go to post</span>
													</a>
													<a class="dropdown-item d-flex align-items-center" href="#">
														<i class="las la-share-alt icon-sm mr-2"></i> <span class="">Share</span>
													</a>
													<a class="dropdown-item d-flex align-items-center" href="#">
														<i class="las la-copy icon-sm mr-2"></i> <span class="">Copy link</span>
													</a>
												</div>
											</div>
										</div>
									</div>
								</form>
								<!--Fim Criar PUBLICACAO-->
								<!--<div class="card-body">
										<p class="mb-3 tx-14">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Accusamus minima delectus nemo unde quae recusandae assumenda.</p>
										<img class="img-fluid" src="https://cdn.pixabay.com/photo/2014/12/16/22/25/sunset-570881_960_720.jpg" alt="">
									</div>
									<div class="card-footer">
										<div class="d-flex post-actions">
											<a href="javascript:;" class="d-flex align-items-center text-muted mr-4">
												<i class="las la-heart icon-md"></i>
												<p class="d-none d-md-block ml-2 mt-3">Curtir</p>
											</a>
											<a href="javascript:;" class="d-flex align-items-center text-muted mr-4">
												<i class="las la-comment icon-md"></i>
												<p class="d-none d-md-block ml-2 mt-3">Comentar</p>
											</a>
											<a href="javascript:;" class="d-flex align-items-center text-muted">
												<i class="las la-share icon-md"></i>
												<p class="d-none d-md-block ml-2 mt-3">Compartilhar</p>
											</a>
										</div>
								</div>-->

							</div>
						</div>
						<!--Começo feed-->
						@foreach (var item in ViewBag.Feed)
						{
							<div class="col-md-12 mb-4">
								<div class="card rounded shadow-sm">
									<div class="card-header">
										<div class="d-flex align-items-center justify-content-between">
											<div class="d-flex align-items-center">
												<img class="img-xs rounded-circle mr-2" src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="">
												<div>
													<p class="mb-0"><strong>@item.Usuario.Nome @item.Usuario.Sobrenome</strong></p>
													<p class="tx-11 text-muted">5 min ago</p>
												</div>
											</div>
											<div class="dropdown">
												<button class="btn p-0" type="button" id="dropdownMenuButton-@item.Id" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
													<i class="las la-ellipsis-h icon-lg"></i>
												</button>
												<div class="dropdown-menu" aria-labelledby="dropdownMenuButton-@item.Id">
													<a class="dropdown-item" href="#"><i class="las la-meh icon-sm mr-2"></i> Unfollow</a>
													<a class="dropdown-item" href="#"><i class="las la-level-up-alt icon-sm mr-2"></i> Go to post</a>
												</div>
											</div>
										</div>
									</div>
									<div class="card-body">
										<p class="mb-3 tx-14">@item.Descricao</p>
										<img class="img-fluid rounded" src="https://t.ctcdn.com.br/JtxqlT7X1-WrrL4yuAebx7ubVaI=/1200x675/smart/i726432.jpeg" alt="">
									</div>
									<div class="card-footer">
										<div class="d-flex justify-content-between align-items-center">
											<div class="post-actions">
												@if (item.DidLike)
												{
													<form asp-action='DescurtirPost' asp-controller='Feed' method='DELETE'>
														<button class="btn btn-link text-muted" type="submit">
															<i class="las la-heart icon-lg text-danger"></i>
															<span class="ml-2">@item.Curtidas</span>
														</button>
													</form>
												}
												else
												{
													<form asp-action='CurtirPost' asp-controller='Feed' method='POST'>
														<button class="btn btn-link text-muted" type="submit">
															<i class="las la-heart icon-lg"></i>
															<span class="ml-2">@item.Curtidas</span>
														</button>
													</form>
												}
											</div>
											<div>
												<form asp-action="UsuarioPublicacao" asp-controller='Usuario' method="POST" class="ml-3">
													<input id="Id" name="Id" value="@item.Id" type="hidden" />
													<button class="btn btn-link text-muted" type="submit">
														<i class="las la-comment icon-md"></i>
														<span class="ml-2">Comentar</span>
													</button>
												</form>
											</div>
										</div>
									</div>
									<div class="comments">
										@foreach (var comentario in item.ListaComentarios)
										{
											<div class="card mt-3 rounded shadow-sm">
												<div class="card-header">
													<div class="d-flex align-items-center justify-content-between">
														<div class="d-flex align-items-center">
															<img class="img-xs rounded-circle mr-2" src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="">
															<div>
																<p class="mb-0">@item.Usuario.Sobrenome comentou:</p>
																<p class="mb-0">@comentario.Conteudo</p>
																<p class="tx-11 text-muted">5 min ago</p>
															</div>
														</div>
														<div class="dropdown">
															<button class="btn p-0" type="button" id="dropdownMenuButton-@comentario.Id" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
																<i class="las la-ellipsis-h icon-lg"></i>
															</button>
															<div class="dropdown-menu" aria-labelledby="dropdownMenuButton-@comentario.Id">
																<a class="dropdown-item" href="#"><i class="las la-meh icon-sm mr-2"></i> Unfollow</a>
																<a class="dropdown-item" href="#"><i class="las la-level-up-alt icon-sm mr-2"></i> Go to post</a>
															</div>
														</div>
													</div>
												</div>
											</div>
										}
									</div>
								</div>
							</div>
						}

						<!--Fim feed-->
					</div>
				</div>
				<!-- middle wrapper end -->
				<!-- right wrapper start -->
				<div class="d-none d-xl-block col-xl-3 right-wrapper">
					<div class="row">
						<div class="col-md-12 grid-margin">
							<div class="card rounded">
								<div class="card-body">
									<h6 class="card-title">Últimas Fotos</h6>
									<div class="latest-photos">
										<div class="row">
											<div class="col-md-4">
												<figure>
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure>
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar2.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure>
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar3.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure>
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar4.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure>
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar5.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure>
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure class="mb-0">
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure class="mb-0">
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar8.png" alt="">
												</figure>
											</div>
											<div class="col-md-4">
												<figure class="mb-0">
													<img class="img-fluid" src="https://bootdey.com/img/Content/avatar/avatar9.png" alt="">
												</figure>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="col-md-12 grid-margin">
							<div class="card rounded">
								<div class="card-body">
									<h6 class="card-title">Sugestões para você</h6>
									<div>
										<div class="d-flex justify-content-between mb-2 pb-2 border-bottom">
											<div class="d-flex align-items-center hover-pointer">
												<img class="img-xs rounded-circle" src="https://bootdey.com/img/Content/avatar/avatar2.png" alt="">
												<div class="ml-2">
													<p>Mike Popescu</p>
													<p class="tx-11 text-muted">12 Amigos em Comum</p>
												</div>
											</div>

											<button class="btn btn-icon">
												<i class="las la-user-plus icon-md" data-toggle="tooltip" title="" data-original-title="Connect"></i>
											</button>
										</div>

										<div class="d-flex justify-content-between mb-2 pb-2 border-bottom">
											<div class="d-flex align-items-center hover-pointer">
												<img class="img-xs rounded-circle" src="https://bootdey.com/img/Content/avatar/avatar3.png" alt="">
												<div class="ml-2">
													<p>Mike Popescu</p>
													<p class="tx-11 text-muted">12 Amigos em Comum</p>
												</div>
											</div>

											<button class="btn btn-icon">
												<i class="las la-user-plus icon-md" data-toggle="tooltip" title="" data-original-title="Connect"></i>
											</button>
										</div>
										<div class="d-flex justify-content-between mb-2 pb-2 border-bottom">
											<div class="d-flex align-items-center hover-pointer">
												<img class="img-xs rounded-circle" src="https://bootdey.com/img/Content/avatar/avatar4.png" alt="">
												<div class="ml-2">
													<p>Mike Popescu</p>
													<p class="tx-11 text-muted">12 Amigos em Comum</p>
												</div>
											</div>
											<button class="btn btn-icon">
												<i class="las la-user-plus icon-md" data-toggle="tooltip" title="" data-original-title="Connect"></i>
											</button>
										</div>
										<div class="d-flex justify-content-between mb-2 pb-2 border-bottom">
											<div class="d-flex align-items-center hover-pointer">
												<img class="img-xs rounded-circle" src="https://bootdey.com/img/Content/avatar/avatar5.png" alt="">
												<div class="ml-2">
													<p>Mike Popescu</p>
													<p class="tx-11 text-muted">12 Amigos em Comum</p>
												</div>
											</div>
											<button class="btn btn-icon">
												<i class="las la-user-plus icon-md" data-toggle="tooltip" title="" data-original-title="Connect"></i>
											</button>
										</div>
										<div class="d-flex justify-content-between mb-2 pb-2 border-bottom">
											<div class="d-flex align-items-center hover-pointer">
												<img class="img-xs rounded-circle" src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="">
												<div class="ml-2">
													<p>Mike Popescu</p>
													<p class="tx-11 text-muted">12 Amigos em Comum</p>
												</div>
											</div>
											<button class="btn btn-icon">
												<i class="las la-user-plus icon-md" data-toggle="tooltip" title="" data-original-title="Connect"></i>
											</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- right wrapper end -->
			</div>
		</div>
	</div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
	function curtirDescurtirPublicacao(element) {

		let idPublicacao = $(element).attr("data-id");

		if (!$(element).hasClass("active")) {
			$.ajax({
				url: 'Curtir/' + idPublicacao,
				type: 'POST',
				contentType: 'application/json',
				success: function (response) {

					let nrLikes = parseInt($(element).text().split("(")[1].split(")")[0].trim())
					nrLikes++;

					$(element).addClass("active");

					$(element).text("Curtiu (" + nrLikes + ")");
				},
				error: function (error) {
					console.log(error);
				}
			});
		} else {
			$.ajax({
				url: 'Descurtir/' + idPublicacao,
				type: 'DELETE',
				contentType: 'application/json',
				success: function (response) {

					let nrLikes = parseInt($(element).text().split("(")[1].split(")")[0].trim())
					nrLikes--;

					$(element).removeClass("active");

					$(element).text("Curtir (" + nrLikes + ")");
				},
				error: function (error) {
					console.log(error);
				}
			});
		}

	}

</script>